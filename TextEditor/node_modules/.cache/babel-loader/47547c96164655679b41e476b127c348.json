{"ast":null,"code":"var _jsxFileName = \"/Users/pgurjar/Desktop/group10/TextEditor/src/components/ImportExport.js\";\nimport React, { useState } from \"react\";\nimport { read, utils, writeFile } from \"xlsx\";\nimport styles from \"./ImportExport.module.css\";\nimport './ImportExport.module.css';\n\nconst ImportExport = () => {\n  const [movies, setMovies] = useState([]);\n\n  const handleImport = $event => {\n    const files = $event.target.files;\n\n    if (files.length) {\n      const file = files[0];\n      const reader = new FileReader();\n\n      reader.onload = event => {\n        const wb = read(event.target.result);\n        const sheets = wb.SheetNames;\n\n        if (sheets.length) {\n          const rows = utils.sheet_to_json(wb.Sheets[sheets[0]]);\n          setMovies(rows);\n        }\n      };\n\n      reader.readAsArrayBuffer(file);\n    }\n  };\n\n  const handleExport = () => {\n    const headings = [[\"Movie\", \"Category\", \"Director\", \"Rating\"]];\n    const wb = utils.book_new();\n    const ws = utils.json_to_sheet([]);\n    utils.sheet_add_aoa(ws, headings);\n    utils.sheet_add_json(ws, movies, {\n      origin: \"A2\",\n      skipHeader: true\n    });\n    utils.book_append_sheet(wb, ws, \"Report\");\n    writeFile(wb, \"Movie Report.xlsx\");\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"styles.row mb-2 mt-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-6 offset-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"input-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"custom-file\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    name: \"file\",\n    className: \"custom-file-input\",\n    id: \"inputGroupFile\",\n    required: true,\n    onChange: handleImport,\n    accept: \".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 37\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    className: \"custom-file-label\",\n    htmlFor: \"inputGroupFile\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 37\n    }\n  }, \"Choose file\")))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleExport,\n    className: \"btn btn-primary float-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 29\n    }\n  }, \"Export \", /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fa fa-download\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 40\n    }\n  })))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-6 offset-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"table\", {\n    className: \"table\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 33\n    }\n  }, \"Id\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 33\n    }\n  }, \"Movie\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 33\n    }\n  }, \"Category\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 33\n    }\n  }, \"Director\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 33\n    }\n  }, \"Rating\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 25\n    }\n  }, movies.length ? movies.map((movie, index) => /*#__PURE__*/React.createElement(\"tr\", {\n    key: index,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 41\n    }\n  }, index + 1), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 41\n    }\n  }, movie.Movie), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 41\n    }\n  }, movie.Category), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 41\n    }\n  }, movie.Director), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"badge bg-warning text-dark\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 45\n    }\n  }, movie.Rating)))) : /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    colSpan: \"5\",\n    className: \"text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 37\n    }\n  }, \"No Movies Found.\")))))));\n};\n\nexport default ImportExport;","map":{"version":3,"sources":["/Users/pgurjar/Desktop/group10/TextEditor/src/components/ImportExport.js"],"names":["React","useState","read","utils","writeFile","styles","ImportExport","movies","setMovies","handleImport","$event","files","target","length","file","reader","FileReader","onload","event","wb","result","sheets","SheetNames","rows","sheet_to_json","Sheets","readAsArrayBuffer","handleExport","headings","book_new","ws","json_to_sheet","sheet_add_aoa","sheet_add_json","origin","skipHeader","book_append_sheet","map","movie","index","Movie","Category","Director","Rating"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { read, utils, writeFile } from \"xlsx\";\nimport styles from \"./ImportExport.module.css\";\nimport './ImportExport.module.css'\n\nconst ImportExport = () => {\n    const [movies, setMovies] = useState([]);\n\n    const handleImport = ($event) => {\n        const files = $event.target.files;\n        if (files.length) {\n            const file = files[0];\n            const reader = new FileReader();\n            reader.onload = (event) => {\n                const wb = read(event.target.result);\n                const sheets = wb.SheetNames;\n\n                if (sheets.length) {\n                    const rows = utils.sheet_to_json(wb.Sheets[sheets[0]]);\n                    setMovies(rows);\n                }\n            };\n            reader.readAsArrayBuffer(file);\n        }\n    };\n\n    const handleExport = () => {\n        const headings = [[\"Movie\", \"Category\", \"Director\", \"Rating\"]];\n        const wb = utils.book_new();\n        const ws = utils.json_to_sheet([]);\n        utils.sheet_add_aoa(ws, headings);\n        utils.sheet_add_json(ws, movies, { origin: \"A2\", skipHeader: true });\n        utils.book_append_sheet(wb, ws, \"Report\");\n        writeFile(wb, \"Movie Report.xlsx\");\n    };\n\n    return (\n        <>\n            <div className=\"styles.row mb-2 mt-5\">\n                <div className=\"col-sm-6 offset-3\">\n                    <div className=\"row\">\n                        <div className=\"col-md-6\">\n                            <div className=\"input-group\">\n                                <div className=\"custom-file\">\n                                    <input\n                                        type=\"file\"\n                                        name=\"file\"\n                                        className=\"custom-file-input\"\n                                        id=\"inputGroupFile\"\n                                        required\n                                        onChange={handleImport}\n                                        accept=\".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel\"\n                                    />\n                                    <label\n                                        className=\"custom-file-label\"\n                                        htmlFor=\"inputGroupFile\"\n                                    >\n                                        Choose file\n                                    </label>\n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"col-md-6\">\n                            <button\n                                onClick={handleExport}\n                                className=\"btn btn-primary float-right\"\n                            >\n                                Export <i className=\"fa fa-download\"></i>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div className=\"row\">\n                <div className=\"col-sm-6 offset-3\">\n                    <table className=\"table\">\n                        <thead>\n                            <tr>\n                                <th scope=\"col\">Id</th>\n                                <th scope=\"col\">Movie</th>\n                                <th scope=\"col\">Category</th>\n                                <th scope=\"col\">Director</th>\n                                <th scope=\"col\">Rating</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {movies.length ? (\n                                movies.map((movie, index) => (\n                                    <tr key={index}>\n                                        <th scope=\"row\">{index + 1}</th>\n                                        <td>{movie.Movie}</td>\n                                        <td>{movie.Category}</td>\n                                        <td>{movie.Director}</td>\n                                        <td>\n                                            <span className=\"badge bg-warning text-dark\">\n                                                {movie.Rating}\n                                            </span>\n                                        </td>\n                                    </tr>\n                                ))\n                            ) : (\n                                <tr>\n                                    <td colSpan=\"5\" className=\"text-center\">\n                                        No Movies Found.\n                                    </td>\n                                </tr>\n                            )}\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default ImportExport;\n"]},"metadata":{},"sourceType":"module"}